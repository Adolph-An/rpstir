RPKI Syntax Conformance Test Cases

Goal: generate a repository that tests the

output/root.cer
       root/root.crl
            root.roa
            root.mft
            badCert*.cer
            badCMS*.roa
            badROA.roa
            goodCert.cer
            goodCert/goodCert.crl
                     goodCert.roa
                     goodCert.mft
            testCRL*.cer
            testCRL*/badCRL*.crl
                     goodmft.mft
                     goodroa*.roa?
             :
             :
            testMFT*.cer
            testMFT*/goodcrl.crl
                     badMFT*.mft
                     goodroa*.roa?
             :
             :


CA Certificates

101 AIA2AccessDesc      # two AccessDescriptors
102 AIABadAccess        # wrong accessMethod for rsync URI
103 AIAAccessLoc        # single HTTP accessLoc, no rsync
104 AIACrit             # wrongly mark AIA extension as critical
105 AKIHash             # AKI doesn't match parent SKI
106 AKILth              # AKI is too short (do we want too long?)
107 BadExtension1       # illegal extension (PolicyMappings)
109 BasicConstrNoCA     # BasicConstr present, but cA not set
110 BasicConstrNoCrit   # BasicConstr present, crit bit unset
111 BasicConstrPathLth  # BasicConstr path length present
112 Cpol2oid            # More than one Certificate Policy OID (more?)
113 CpolNoCrit          # CertPolicy extension, crit bit unset
114 CRLDP2DistPt        # CRL Dist Pt has 2 Dist points
115 CRLDPCrit           # CRL Dist Pt marked critical
116 CRLDPCrlIssuer      # CRL Dist Pt has CRL Issuer
117 CRLDPNoDistPt       # CRL DIST PT has no Dist Pt
118 CRLDPReasons        # CRL Dist Pt has reasons
119 EKU                 # has Extended KeyUsage
120 InnerSigAlg         # wrong signature algorithm in toBeSigned
121 IssuerOID           # issuer name is not id_commonName
122 Issuer2Sets         # issuer name has 2 sets
123 IssuerUtf           # issuer name has utf name
124 Issuer2Seq          # issuer name has 2 sequences
125 Issuer2SerNums      # issuer name has 2 serial numbers
126 IssUID              # has issuer unique ID
127 KUsageExtra         # has disallowed key usage bit
128 KUsageNoCertSign    # lacks bit for signing certificates
129 KUsageNoCrit        # key usage extension not critical
131 KUsageNoCRLSign     # lacks bit for signing CRLs
134 OuterSigAlg         # wrong signature algorithm in cert.algorithm
135 PubKeyAlg           # wrong SubjectPublicKey algorithm
136 PubKeyExp           # wrong SubjectPublicKey exponent
137 PubKeyLth           # wrong SubjectPublicKey length
138 ResourcesASNoCrit   # AS number extension not critical
139 ResourcesBadAFI     # invalid IP address family
140 ResourcesBadASOrder # AS numbers out of order
141 ResourcesBadV4Order # IPv4 addresses out of order
142 ResourcesBadV6Order # IPv6 addresses out of order
143 ResourcesIPNoCrit   # IP address extension not critical
144 ResourcesNone       # no IP addresses or AS numbers
145 ResourcesSAFI       # IP addresses has SAFI digit
147 SIAAccessLoc        # subject info access extension has non-rsync locator
148 SIAAccessMethod     # subject info access extension has bad access method
149 SIAMissing          # no subject info access extension
150 SKIHash             # incorrect subject key identifier
151 SKILth              # incorrect subject key identifier length
152 SubjectOID          # subject name is not id_commonName
153 Subject2Sets        # subject name has 2 sets
154 SubjectUtf          # subject name has utf name
155 Subject2Seq         # subject name has 2 sequences
156 Subject2SerNum      # subject name has 2 serial numbers
157 SubjUID             # has subject unique ID
158 ValCrossed          # beginning validity date > ending date
159 ValFromFuture       # starting validity date is in future
160 ValFromTyp          # starting validity is of wrong type
162 ValToPast           # ending validity date has passed
163 ValToTyp            # ending date is of wrong type
164 VersionNeg          # version number is negative
165 Version1            # version number is v1, i.e. 0
166 Version2            # version number is v2, i.e. 1
167 Version4            # version number is v4, i.e. 3
168 SerNum              # negative serial number
169 AIA2x               # two authority info access extensions
170 SIA2x               # two subject info access extensions
171 NoAIA               # no authority info access extension
172 NoSIA               # no subject info access extension
173 NoBasicConstr       # no basic constraints extension
174 2BasicConstr        # two basic constraints extensions
175 NoSKI               # no subject key identifier extension
176 2SKI                # two subject key identifier extensions
177 NoAKI               # no authority key identifier extension
178 2AKI                # two authority key identifier extensions
179 NoKeyUsage          # no key usage extension
180 2KeyUsage           # two key usage extensions
181 2CRLDP              # two CRLDP extensions
182 NoCRLDP             # no CRLDP extension
183 NoCpol              # no certificate policies extension
184 2Cpol               # two certificate policies extensions
185 2IPAddr             # two IP address extensions
186 2ASNum              # two AS number extensions


EE Certificates (embedded in ROAs)

??? We may not have created these at all.  We need:
1. keyUsage
2. SIA (id-ad-signedObject)
3. EE inherits, but ROA IPAddress too big


CMS signed objects, generic (using ROAs)

../../scripts/make_test_CMS.sh CMS ContentType roa 512
../../scripts/make_test_CMS.sh CMS NoCerts roa 513
../../scripts/make_test_CMS.sh CMS 2Certs roa 514
../../scripts/make_test_CMS.sh CMS Version2 roa 515
../../scripts/make_test_CMS.sh CMS Version4 roa 516
../../scripts/make_test_CMS.sh CMS DigestAlg roa 517
../../scripts/make_test_CMS.sh CMS 2DigestAlgs roa 518
../../scripts/make_test_CMS.sh CMS NoDigestAlgs roa 519
../../scripts/make_test_CMS.sh CMS HasCRL roa 520
../../scripts/make_test_CMS.sh CMS NoSignerInfo roa 522
../../scripts/make_test_CMS.sh CMS SigInfoVersion roa 523
../../scripts/make_test_CMS.sh CMS SigInfoVersion4 roa 524
../../scripts/make_test_CMS.sh CMS SigInfoNoSid roa 525
../../scripts/make_test_CMS.sh CMS SigInfoWrongSid roa 526
../../scripts/make_test_CMS.sh CMS SigInfoBadSid roa 527
../../scripts/make_test_CMS.sh CMS SigInfoHashAlg roa 528
../../scripts/make_test_CMS.sh CMS SigInfoNoAttrs roa 529
../../scripts/make_test_CMS.sh CMS SigInfoAttrsNoContType roa 530
../../scripts/make_test_CMS.sh CMS SigInfoAttrsContTypeOid roa 531
../../scripts/make_test_CMS.sh CMS SigInfoAttrsMsgDigestOid roa 532
../../scripts/make_test_CMS.sh CMS SigInfoAttrsNoMsgDigest roa 533
../../scripts/make_test_CMS.sh CMS SigInfoAttrs2ContType roa 534
../../scripts/make_test_CMS.sh CMS SigInfoAttrs2MsgDigest roa 535
../../scripts/make_test_CMS.sh CMS SigInfoAttrs2SigTime roa 536
../../scripts/make_test_CMS.sh CMS SigInfoAttrs2BinSigTime roa 537
../../scripts/make_test_CMS.sh CMS SigInfoUnSigAttrs roa 538
../../scripts/make_test_CMS.sh CMS SigInfoNoSig roa 539
../../scripts/make_test_CMS.sh CMS SigInfo2Sig roa 540
../../scripts/make_test_CMS.sh CMS SigInfoNoSigAlg roa 541
../../scripts/make_test_CMS.sh CMS SigInfoNoHashAlg roa 542
../../scripts/make_test_CMS.sh CMS KeyUsage roa 543


ROAs

../../scripts/make_test_CMS.sh ROA Version roa 550
../../scripts/make_test_CMS.sh ROA ASID roa 551
../../scripts/make_test_CMS.sh ROA Family roa 552
../../scripts/make_test_CMS.sh ROA FamilyLth roa 553
../../scripts/make_test_CMS.sh ROA IPMaxLth roa 554
../../scripts/make_test_CMS.sh ROA Version4 roa 550


CRLs

../../scripts/make_test_CRL.sh 640 CRLNoVersion
../../scripts/make_test_CRL.sh 641 CRLVersion0
../../scripts/make_test_CRL.sh 642 CRLSigAlgInner
../../scripts/make_test_CRL.sh 643 CRLSigAlgOuter
../../scripts/make_test_CRL.sh 644 CRLIssuerOID
../../scripts/make_test_CRL.sh 645 CRLIssuer2Sets
../../scripts/make_test_CRL.sh 646 CRLIssuerUTF
../../scripts/make_test_CRL.sh 647 CRLIssuer2Seq
../../scripts/make_test_CRL.sh 648 CRLIssuer2SerNums
../../scripts/make_test_CRL.sh 649 CRLLastUpdateFuture
../../scripts/make_test_CRL.sh 650 CRLLastUpdateTyp
../../scripts/make_test_CRL.sh 651 CRLNextUpdatePast
../../scripts/make_test_CRL.sh 652 CRLNextUpdateTyp
../../scripts/make_test_CRL.sh 653 CRLUpdatesCrossed
../../scripts/make_test_CRL.sh 654 CRLIssAltName
../../scripts/make_test_CRL.sh 655 CRLIssDistPt
../../scripts/make_test_CRL.sh 656 CRLDeltaCRLInd
../../scripts/make_test_CRL.sh 657 CRLNoAKI
../../scripts/make_test_CRL.sh 658 CRLNoCRLNum
../../scripts/make_test_CRL.sh 659 CRLEntryNoSerNum
../../scripts/make_test_CRL.sh 660 CRLEntryNoRevDate
../../scripts/make_test_CRL.sh 661 CRLEntryReason


Manifests

../../scripts/make_test_manifest.sh 768 MFTWrongType
../../scripts/make_test_manifest.sh 769 MFTVersion0
../../scripts/make_test_manifest.sh 770 MFTVersion1
../../scripts/make_test_manifest.sh 771 MFTNoNum
../../scripts/make_test_manifest.sh 772 MFTNegNum
../../scripts/make_test_manifest.sh 773 MFTThisUpdUTC
../../scripts/make_test_manifest.sh 774 MFTThisUpdFuture
../../scripts/make_test_manifest.sh 775 MFTNextUpdUTC
../../scripts/make_test_manifest.sh 776 MFTNextUpdPast
../../scripts/make_test_manifest.sh 777 MFTHashAlg
../../scripts/make_test_manifest.sh 779 MFTFileHashShort
../../scripts/make_test_manifest.sh 780 MFTFileHashLong
../../scripts/make_test_manifest.sh 781 MFTFileNotIA5
../../scripts/make_test_manifest.sh 782 MFTHashOctetStr
