RPKI Syntax Conformance Test Cases

# Directory layout of rsync://rpki.bbn.com/conformance/
root.cer
root/root.crl
     root.mft
     badCert*.cer
     badCMS*.roa
     badROA.roa
     testCRL*.cer
     testCRL*/badCRL*.crl
              goodmft.mft
      :
      :
     testMFT*.cer
     testMFT*/goodcrl.crl
              badMFT*.mft
      :
      :

In theory, a conforming RPKI validator should reject any file whose
filename begins with "bad", and accept all other files.  We chose to
give each CRL and MFT test case its own subdirectory; this is because
we wanted to test the way a validator handles individual files, not
how it handles a convoluted repository structure.

# Caveat emptor: these test cases aren't finished yet, and some will
# be removed.  E.g., some are not "syntax" conformance cases because
# they would require checking the relationship *between* files, not
# just checking the syntax of a single file.


CA Certificates

101 AIA2AccessDescHtRs  # (good) AIA with two access descriptions (http+rsync) 6487#4.8.7
    AIA2AccessDescRsRs  # (good) AIA with two access descriptions (2 rsync) 6487#4.8.7
102 AIABadAccess        # wrong accessMethod for rsync URI 6487#4.8.7
103 AIAAccessLoc        # single HTTP accessLoc, no rsync 6487#4.8.7
104 AIACrit             # wrongly mark AIA extension as critical 6487#4.8.7
105 AKIHash             # AKI doesn't match parent SKI -- NOTE: not syntax check 6487#4.8.3
106 AKIShort            # AKI is too short 6487#4.8.3
    AKILong             # AKI is too long 6487#4.8.3
    AKIHasACI           # AKI has authorityCertIssuer present  6487#4.8.3
    AKIHasACSN          # AKI has authorityCertSerialNumber present  6487#4.8.3
107 UnkExtension        # unrecognized non-critical extension (PolicyMappings) 6487#1,4.8,8
    UnkExtensionCrit    # unrecognized critical extension (PolicyMappings) 5280#4.2
109 BasicConstrNoCA     # BasicConstr present, but cA not set 6487#4.8.1
110 BasicConstrNoCrit   # BasicConstr present, crit bit unset 6487#4.8.1
111 BasicConstrPathLth  # BasicConstr path length present 6487#4.8.1
112 Cpol2oid1correct    # One correct, one incorrect Cert Policy OID 6487#4.8.9 6484#1.2
    Cpol2oid2correct    # Two correct Cert Policy OIDs 6487#4.8.9 6484#1.2
    CpolBadOid          # One incorrect Cert Policy OID 6487#4.8.9 6484#1.2
113 CpolNoCrit          # CertPolicy extension, crit bit unset 6487#4.8.9
114 CRLDP2DistPt        # (good) CRL Dist Pt has 2 Dist points 6487#4.8.6
115 CRLDPCrit           # CRL Dist Pt marked critical 6487#4.8.6
116 CRLDPCrlIssuer      # CRL Dist Pt has CRL Issuer 6487#4.8.6
118 CRLDPReasons        # CRL Dist Pt has reasons 6487#4.8.6
119 EKU                 # has Extended KeyUsage 6487#4.8.5
120 InnerSigAlg         # wrong signature algorithm in toBeSigned (i.e. mismatch) 6485#2, 5280#4.1.2.3
    BothSigAlg          # wrong signature algorithms (but matching each other) 6485#2
121 IssuerOID           # issuer name is not id_commonName 6487#4.4
122 Issuer2ComName      # issuer name has 2 common names (same set) 6487#4.4
123 IssuerUtf           # issuer name has utf name 6487#4.4
124 Issuer2SetComName   # issuer name has 2 sets with common names 6487#4.4
125 IssuerSerNum        # issuer name has only a serial number 6487#4.4
    IssuerSeqNameSer    # (good) issuer with name before serial number (2 sets) 6487#4.4
    IssuerSeqSerName    # (good) issuer with serial number before name (2 sets) 6487#4.4
    IssuerSetNameSer    # (good) issuer with serial number and name (1 set) 6487#4.4
126 IssUID              # has issuer unique ID 6487#4
127 KUsageExtra         # has disallowed key usage bit 6487#4.8.4
128 KUsageNoCertSign    # lacks bit for signing certificates 6487#4.8.4
129 KUsageNoCrit        # key usage extension not critical 6487#4.8.4
131 KUsageNoCRLSign     # lacks bit for signing CRLs 6487#4.8.4
134 OuterSigAlg         # wrong signature algorithm in cert.algorithm (i.e. mismatch) 6485#2, 5280#4.1.2.3
135 PubKeyAlg           # wrong SubjectPublicKey algorithm 6485#3.1 Is this right???
136 PubKeyExp           # wrong SubjectPublicKey exponent 6485#3
137 PubKeyShort         # SubjectPublicKey is 2047-bit 6485#3
    PubKeyLong          # SubjectPublicKey is 2049-bit 6485#3
138 ResourcesASNoCrit   # AS number extension not critical 6487#4.8.11
139 ResourcesBadAFI     # invalid IP address family 6487#4.8.10, IANA address-family-numbers
140 ResourcesBadASOrder # AS numbers out of order 3779 (but full set is pending)
141 ResourcesBadV4Order # IPv4 addresses out of order 3779 (but full set is pending)
142 ResourcesBadV6Order # IPv6 addresses out of order 3779 (but full set is pending)
143 ResourcesIPNoCrit   # IP address extension not critical 6487#4.8.10
144 ResourcesNone       # neither AS nor IP 3779 extensions 6487#4.8.10
    ResourcesIPEmpty    # empty set of IP addresses 6487#4.8.10
    ResourcesASEmpty    # empty set of AS numbers 6487#4.8.11
145 ResourcesSAFI       # IP addresses has SAFI digit 6487#4.8.10
    ResourcesIP6Inherit # (good) inherit IPv6 resources only, others explicit 6487#4.8.10
    ResourcesIP4Inherit # (good) inherit IPv4 resources only, others explicit 6487#4.8.10
    ResourcesASInherit  # (good) inherit AS resources only, others explicit 6487#4.8.11
    ResourcesAllInherit # (good) inherit all resources 6487#4.8.10
    ResourcesIP6InhOnly # (good) inherit IPv6 resources only, others not present 6487#4.8.10
    ResourcesIP4InhOnly # (good) inherit IPv4 resources only, others not present 6487#4.8.10
    ResourcesASInhOnly  # (good) inherit AS resources only, others not present 6487#4.8.11
147 SIARepoNoRsync      # SIA has no rsync locator for id-ad-caRepository 6487#4.8.8
    SIAMFTNoRsync       # SIA has no rsync locator for id-ad-rpkiManifest 6487#4.8.8
    SIARepo2Rsync       # (good) SIA has 2 rsync locators for id-ad-caRepository 6487#4.8.8
    SIAMFT2Rsync        # (good) SIA has 2 rsync locators for id-ad-rpkiManifest 6487#4.8.8
    SIARepoHtRs         # (good) SIA has http+rsync locators for id-ad-caRepository 6487#4.8.8
    SIAMFTHtRs          # (good) SIA has http+rsync locators for id-ad-rpkiManifest 6487#4.8.8
    SIARepoHasNonURI    # SIA has rsync+non-URI locators for id-ad-caRepository 6487#4.8.8
    SIARepoHasNonURI    # (good) SIA has rsync+non-URI locators for id-ad-caRepository 6487#4.8.8
148 SIAAccessMethod     # SIA has bad access method in addition to good accessMethods 6487#4.8.8
    SIANoMFT            # SIA has no id-ad-rpkiManifest 6487#4.8.8
    SIANoRepo           # SIA has no id-ad-caRepository 6487#4.8.8
150 SKIHash             # incorrect subject key identifier 6487#4.8.2
151 SKILong             # SKI length 21 octets 6487#4.8.2
    SKIShort            # SKI length 19 octets 6487#4.8.2
152 SubjectOID          # subject name is not id_commonName 6487#4.5
153 Subject2ComName     # subject name has 2 common names (same set) 6487#4.5
154 SubjectUtf          # subject name has utf name 6487#4.5
155 Subject2SetComName  # subject name has 2 sets with common names 6487#4.5
156 SubjectSerNum       # subject name has only a serial number 6487#4.5
    SubjectSeqNameSer   # (good) subject with name before serial number (2 sets) 6487#4.5
    SubjectSeqSerName   # (good) subject with serial number before name (2 sets) 6487#4.5
    SubjectSetNameSer   # (good) subject with serial number and name (1 set) 6487#4.5
157 SubjUID             # has subject unique ID 6487#4
158 ValCrossed          # beginning validity date > ending date 6487#4.6
159 ValFromFuture       # starting validity date is in future 6487#4.6.1
160 ValFromTyp          # starting validity is of wrong type
162 ValToPast           # ending validity date has passed
163 ValToTyp            # ending date is of wrong type
164 VersionNeg          # version number is negative
165 Version1            # version number is v1, i.e. 0
166 Version2            # version number is v2, i.e. 1
167 Version4            # version number is v4, i.e. 3
168 SerNum              # negative serial number
    SerNum0             # zero serial number 5280#4.1.2.2 (may need errata)
169 AIA2x               # two authority info access extensions
170 SIA2x               # two SIAs
171 NoAIA               # no authority info access extension
172 NoSIA               # no SIA
173 NoBasicConstr       # no basic constraints extension
174 2BasicConstr        # two basic constraints extensions
175 NoSKI               # no subject key identifier extension
176 2SKI                # two subject key identifier extensions
177 NoAKI               # no authority key identifier extension
178 2AKI                # two authority key identifier extensions
179 NoKeyUsage          # no key usage extension
180 2KeyUsage           # two key usage extensions
181 2CRLDP              # two CRLDP extensions
182 NoCRLDP             # no CRLDP extension
183 NoCpol              # no certificate policies extension
184 2Cpol               # two certificate policies extensions
185 2IPAddr             # two IP address extensions
186 2ASNum              # two AS number extensions
187 CRLDPNoRsyncDistPt  # no rsync URI in CRLDP
188 IssuerSet2SerNums   # issuer name has 2 serial numbers (same set) 6487#4.4
189 SubjectSet2SerNums  # subject name has 2 serial numbers (same set) 6487#4.5
    IssuerSeq2SerNums   # issuer name has 2 serial numbers (split across sets) 6487#4.4
    SubjectSeq2SerNums  # subject name has 2 serial numbers (split across sets) 6487#4.5


CMS signed objects, generic (using ROAs)

512 ContentType              # wrong content type
513 NoCerts                  # no certificate
514 2Certs                   # two certificates
515 Version2                 # version 2
516 Version4                 # version 4
517 DigestAlg                # wrong digest algorithm -- inconsistent?
518 2DigestAlgs              # two digest algorithms
519 NoDigestAlgs             # no digest algorithm
520 HasCRL                   # has a CRL
523 SigInfoVersion           # wrong Signer Info version (2)
524 SigInfoVersion4          # wrong Signer Info version (4)
525 SigInfoNoSid             # no Signer Identifier
526 SigInfoWrongSid          # wrong choice of Signer Identifier
527 SigInfoBadSid            # bad Signer Identifier (wrong SKI)
528 SigInfoHashAlg           # wrong hash algorithm in Signer Info
529 SigInfoNoAttrs           # no attributes in Signer Info
530 SigInfoAttrsNoContType   # no content type in Signer Info
531 SigInfoAttrsContTypeOid  # wrong content type OID
532 SigInfoAttrsMsgDigestOid # wrong digest OID attribute
533 SigInfoAttrsNoMsgDigest  # no message digest
534 SigInfoAttrs2ContType    # duplicate content type attributes
535 SigInfoAttrs2MsgDigest   # duplicate digest attributes
536 SigInfoAttrs2SigTime     # duplicate signing time attributes
537 SigInfoAttrs2BinSigTime  # duplicate binary signing time attributes
538 SigInfoUnSigAttrs        # has unsigned attribute
539 SigInfoNoSig             # no signature
540 SigInfo2Sig              # has two signatures
542 SigInfoWrongSigAlg       # has wrong signature algorithm
543 SigInfoNoHashAlg         # had no hash algorithm

EE Certificates (embedded in ROAs)

544 KeyUsage                 # permission to sign certs and CRLs
545 SIAWrongOID              # improper OID in SIA


ROAs

551 ASIDSmall                # AS number out of bounds (too low)
552 ASIDLarge                # AS number out of bounds (too high)
553 Family                   # invalid family
554 FamilyLth                # family name too long
555 IPMaxLth                 # IP max length too long
556 IP2Big                   # IP addresses exceed parent's
557 VersionV1Explicit        # explicit V1 version (int 0) applied before signature
558 VersionV1ExplicitBadSig  # explicit V1 version (int 0) applied after signature
559 VersionV2                # Version V2 (int 1)
                             # IP addresses exceed via inherit?

CRLs

640 CRLNoVersion             # no CRL version field
641 CRLVersion0              # CRL version v1 (integer value 0)
642 CRLSigAlgInner           # wrong signature algorithm ID in toBeSigned 
643 CRLSigAlgOuter           # wrong outer signature algorithm ID
644 CRLIssuerOID             # wrong OID for issuer name
645 CRLIssuer2Sets           # two SETs in issuer name - NEED CLEARER TEXT
646 CRLIssuerUTF             # issuer name in utf not printable string
647 CRLIssuer2Seq            # two SEQUENCEs in issuer name - NEED CLEARER TEXT
648 CRLIssuer2SerNums        # two serial numbers in issuer name
649 CRLThisUpdateFuture      # this update is in the future
650 CRLThisUpdateTyp         # wrong type of date in this update
651 CRLNextUpdatePast        # next update is in the past (STALE CRL, maybe OK)
652 CRLNextUpdateTyp         # wrong type of date in next update
653 CRLUpdatesCrossed        # last date is later then next date
654 CRLIssAltName            # has issuer alternative name extension
655 CRLIssDistPt             # has issuing distribution point extension
656 CRLDeltaCRLInd           # has delta CRL indicator extension
657 CRLNoAKI                 # has no authority key identifier extension
658 CRLNoCRLNum              # has no CRL number
659 CRLEntryReason           # entry has a revocation reason
662 CRLBadDateFeb29          # has Feb. 29 on non-leap year
663 CRLBadDateDayGT30        # has day 31 of 30-day month
664 CRLBadDateDayGT31        # has day 32 of 31-day month
665 CRLBadDateHour           # has hour> 23
666 CRLBadDateMin            # has minute > 59
667 CRLBadDateSec            # has seconds > 59
668 CRLBadDate21000229       # has date Feb. 29 2100 -- not a leap year
669 CRLNumber2Big            # has too long a CRL number
670 CRL2CRLNums              # has 2 CRL numbers
671 CRLBadDateDay0           # has a day number 0
672 CRLBadDateMonth0         # has a month number 0
673 CRLBadDateMonth13        # has a month number > 12

Manifests

768 MFTWrongType             # wrong eContentType
769 MFTVersion0              # non-default version 0
770 MFTVersion1              # version 1
771 MFTNoNum                 # no manifest number
772 MFTNegNum                # negative manifest number
773 MFTThisUpdUTC            # thisUpdate in UTC
774 MFTThisUpdFuture         # thisUpdate in future
775 MFTNextUpdUTC            # nextUpdate in UTC
776 MFTNextUpdPast           # nextUpdate in past
777 MFTHashAlg               # wrong hash algorithm
779 MFTFileHashShort         # too short hash of a file
780 MFTFileHashLong          # too long hash of a file
781 MFTFileNotIA5            # file name not IA5
782 MFTHashOctetStr          # file hash is octet, not bit string
783 MFTDuplicateFileOneHash  # duplicate file name with same hash
784 MFTDuplicateFileTwoHashes # duplicate filename with diff hash


TODO: Trust Anchor (self-signed) certificates

AIA present
CRLDP present
bad AKI
issuer != subject (tricky, will be interpreted as non-self-signed)
