User Commands                                                    RuleEngine(1)

NAME
    
    RuleEngine - checks test ASN.1-encoded files against a file of rules

DESCRIPTION

    RuleEngine [-v] rulefile testfile [...]

        The RuleEngine program tests one or more ASN.1-encoded files against 
    a set of rules generated by the Rule Editor (q.v).  It is called with two 
    file names and an optional 'verbose' switch.  The verbose switch may 
    appear anywhere in the command line after 'RuleEngine'.  The first file 
    name must be the name of the file containing the rules; the other names 
    are of the files to be tested.  If the verbose switch is omitted, the 
    RuleEngine responds on its standard output with one line for each 
    testfile:

        filename passed

    or 

        filename failed

    where 'filename' is the name of a testfile.  

        If a testfile fails, the verbose switch [rpvides a way to obtain more
    information on the cause of the failure. If this switch is present, the 
    response for the failure cases is more elaborate, e.g.

        filename
            Failed at 10.1.2.3.1
            Failed at offset 1234 (0x4D2)

    The numbers between the dots indicate where in the test file the error 
    was detected.  For a certificate or a certificate revocation list, they 
    refer to the "To Be Signed" part.  The meaning of the numbers after the 
    first one are explained further below.  In a certificate the first 
    numbers are: 

        1 Version
        2 Serial number
        3 Signature algorithm
        4 Issuer
        5 Validity
        6 Subject
        7 Subject public key
        8 Subject unique ID (not used)
        9 Issuer unique ID (not used)
       10 Extensions

    In a certificate revocation list, they are:
 
        1 Version
        2 Signature algorithm
        3 Issuer
        4 This updata date
        5 Next update date
        6 Revoked certificates
        7 Extensions

    The next number identifies the member at the next lower level, e.g. 
    "5.1" refers to the first date in Validity, namely the "not before"
    date.  For extensions, that is the explicitly tagged SEQUENCE OF.  The 
    third number in the case of extensions identifies the particular 
    extension in the test file.  Note that, since Extensions is a SEQUENCE 
    OF, the order of the members is not specified; the number shown tells 
    where in the particular sequence the fault was discovered.  Subsequent 
    numbers identify lower level members, thus the example above refers to 
    the second extension's third member (the OCTET STRING wrapper) and the 
    first member in that. 

        If the failure is that a required extension is missing or appears 
    more than once, the verbose response message is

        filename
            Too few/one missing
            Failed in group rule
            Failed at 10.1
            Failed at offset ddd (0xxxx)

    If the extensions have more than one of the same type, the response says
    "Too many" instead of "Too few/one missing".
         
        The "Failed at offset" message provides another way to find the errant
    item, but it requires a tool to dump the test file in some sort of 
    ASCII-hex and an ability to read the ASN.1 encoding.

        The "testdata" directory contains several sample files of rules and
    test cases.  The files suffixed '.txt' are human-readable translations
    of the sample ASN.1 files, e.g. NIRCRL.txt is a translation of NIRCRL.
    The file longCtflist shows the output from running

        RuleEngine newNIRCArules newNIRISP*Ctf -v

    and the file longCRLlist shows the output from running

        RuleEngine newNIRCRLrules newNIR*CRL

    Note: in order to get identical results to those in the *list files,
    you must set your system date to April 4, 2007.
