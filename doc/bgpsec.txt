 



                                                                 S. Kent
Internet-Draft                                               M. Lepinski
Intended status: Standards Track                             M. Reynolds
Expires: September 18, 2010                                          BBN
                                                          March 17, 2010


               A Profile for BGPSEC Router Certificates 
                 draft-ietf-reynolds-bgpsec-rtrcerts-00


Status of this Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/1id-abstracts.html

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on September 18, 2010.

Copyright and License Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document. Code Components extracted from this document must
   included Simplified BSD License text as described in Section 4.e of
   the Legal Trust Provisions and are provided without warranty as
   described in the BSD License.
 


Kent, et al            Expires September 18, 2010               [Page 1]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


















































 


Kent, et al            Expires September 18, 2010               [Page 2]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


Abstract

   This document defines a standard profile for X.509 certificates for
   the purposes of supporting validation of Autonomous System (AS) paths
   in the Border Gateway Protocol (BGP), as part of an extension to that
   protocol known as BGPSEC. BGP is a critical component for the proper
   operation of the Internet as a whole. The BGPSEC protocol is under
   development as a component to address the requirement to provide
   security for the BGP protocol. The goal of BGPSEC is to design a
   protocol for full AS path validation based on the use of strong
   cryptographic primitives. The end-entity (EE) certificates specified
   by this profile are issued under Resource PKI (RPKI) CA certificates,
   containing the RFC 3779 AS number extension, to routers within the
   autonomous system. The certificate asserts that the router(s) holding
   the public key are authorized to send out secure route advertisements
   on behalf of the specified autonomous system. Note that since these
   certificates extend the RPKI [ID.sidr-arch], this profile is based on
   the profile for RPKI resource certificates [ID.res-cert-prof].

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . 5
      1.1  Terminology . . . . . . . . . . . . . . . . . . . . . . . . 6
   2.  Describing Resources in Certificates  . . . . . . . . . . . . . 7
   3.  BGPSEC Router Certificate Fields  . . . . . . . . . . . . . . . 8
      3.1  Version . . . . . . . . . . . . . . . . . . . . . . . . . . 8
      3.2  Serial Number . . . . . . . . . . . . . . . . . . . . . . . 8
      3.3  Signature Algorithm . . . . . . . . . . . . . . . . . . . . 8
      3.4  Issuer  . . . . . . . . . . . . . . . . . . . . . . . . . . 8
      3.5  Subject . . . . . . . . . . . . . . . . . . . . . . . . . . 8
      3.6  Valid From  . . . . . . . . . . . . . . . . . . . . . . . . 9
      3.7  Valid To  . . . . . . . . . . . . . . . . . . . . . . . . . 9
      3.8  Subject Public Key Info . . . . . . . . . . . . . . . . . . 9
      3.9  BGPSEC Router Certificate Version 3 Extension Fields  . . . 9
         3.9.1  Basic Constraints  . . . . . . . . . . . . . . . . . . 9
         3.9.2  Subject Key Identifier . . . . . . . . . . . . . . . . 9
         3.9.3  Authority Key Identifier . . . . . . . . . . . . . .  10
         3.9.4  Key Usage  . . . . . . . . . . . . . . . . . . . . .  10
         3.9.5  Extended Key Usage . . . . . . . . . . . . . . . . .  10
         3.9.6  CRL Distribution Points  . . . . . . . . . . . . . .  10
         3.9.7  Authority Information Access . . . . . . . . . . . .  10
         3.9.8  Subject Information Access . . . . . . . . . . . . .  10
         3.9.9  Certificate Policies . . . . . . . . . . . . . . . .  10
         3.9.10  IP Resources  . . . . . . . . . . . . . . . . . . .  10
         3.9.11  AS Resources  . . . . . . . . . . . . . . . . . . .  10
   4.  BGPSEC Router Certificate Revocation List Profile . . . . . .  12
   5.  BGPSEC Router Certificate Request Profile . . . . . . . . . .  13
   6.  BGPSEC Router Certificate Validation  . . . . . . . . . . . .  14
 


Kent, et al            Expires September 18, 2010               [Page 3]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


   7.  Design Notes  . . . . . . . . . . . . . . . . . . . . . . . .  15
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  16
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  16
   10  References  . . . . . . . . . . . . . . . . . . . . . . . . .  16
      10.1  Normative References . . . . . . . . . . . . . . . . . .  16
      10.2  Informative References . . . . . . . . . . . . . . . . .  17
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  17
   Appendix A: Example BGPSEC Router Certificate . . . . . . . . . .  19
   Appendix B: Example Certificate Revocation List . . . . . . . . .  19







































 


Kent, et al            Expires September 18, 2010               [Page 4]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


1.  Introduction

   This document defines a profile for X.509 end entity certificates
   [X.509] for use in the context of certification of AS paths in the
   BGPSEC protocol. Such certificates are termed "BGPSEC Router
   certificates". The holder of the private key associated with a BGPSEC
   router certificate is authorized to send secure route advertisements
   (BGPSEC UPDATEs) on behalf of the AS(es) named in the certificate.
   That is, a router holding the private key may send to its BGP peers,
   route advertisements that contain the specified AS number(s) as the
   last item in the AS PATH attribute. A key property that BGPSEC will
   provide is that every autonomous system along the AS PATH has
   authorized the advertisement of the given route (to the next AS along
   the AS PATH).

   The primary goal of the BGPSEC protocol is to enable BGP speakers to
   evaluate the validity of AS path info contained in BGP UPDATE
   messages. Path validity is based on two criteria: (1) the
   authorization of the originating AS to originate a prefix; and (2)
   the integrity of the AS path as an indication of the path traversed
   by this AS path info through the Internet. When a BGPSEC capable
   router receives a signed AS path, it SHOULD validate each signature
   in the signed AS path using the public key from a certificate
   associated with a router representing the corresponding AS holder in
   the path. Each BGPSEC Router certificate is a resource certificate,
   as defined in [ID.res-cert-prof]. It must contain an AS number
   extension [RFC3779] corresponding to the AS number in the AS path
   that it is being used to verify.

   The first criterion is satisfied by matching the origin AS number
   against validated data from one or more ROAs that correspond to the
   NLRI in the UPDATE message. The second criterion is met by verifying
   the signature associated with each AS in the AS path info, using the
   corresponding BGPSEC Router certificate. BGPSEC Router certificates
   are validated by establishing a (valid) certificate chain from the
   certificate issued by a trust anchor, through one or more
   intermediaries, to the BGPSEC Router certificate, consistent with
   path validation criteria established in RFC 3779. (This validation
   procedure nominally correspond to validation of an associated set of
   assignment or allocation actions of AS number resources.)

   This document is a profile of [ID.res-cert-prof], which is a profile
   of RFC 5280. It establishes requirements imposed on a Resource
   certificate to be a BGPSEC Router certificate, i.e., it defines
   constraints for certificate fields and extensions for the certificate
   to be valid in this context. A relying party processing what purports
   to be a BGPSEC Router certificate MUST verify that the certificate
   conforms to this profile.
 


Kent, et al            Expires September 18, 2010               [Page 5]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


1.1  Terminology

   It is assumed that the reader is familiar with the terms and concepts
   described in "Internet X.509 Public Key Infrastructure Certificate
   and Certificate Revocation List (CRL) Profile" [RFC5280], "X.509
   Extensions for IP Addresses and AS Identifiers" [RFC3779],
   "Capability Advertisement with BGP-4" [RFC 5492], "Considerations in
   Validating the Path in BGP" [RFC 5123], "BGP Security Vulnerabilities
   Analysis" [RFC 4272], and "A Border Gateway Protocol 4 (BGP-4)" [RFC
   4271].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119.


































 


Kent, et al            Expires September 18, 2010               [Page 6]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


2.  Describing Resources in Certificates

   The framework for describing an association between the subject of a
   certificate and the AS resources currently under the subject's
   control is described in RFC 3779.

   There are two aspects of this resource extension that are noted in
   this profile. First, RFC 3779 notes that a resource extension SHOULD
   be a CRITICAL extension to the X.509 certificate. This BGPSEC Router
   certificate profile further specifies that the use of this
   certificate extension MUST be used in all BGPSEC Router certificates
   and MUST be marked as CRITICAL. Second, a test of the resource
   extension in the context of certificate validity includes the
   condition that the resources described in the immediate parent CA
   certificate in the PKI (the certificate where this certificate's
   issuer is the subject) has a resource set, hereinafter called the
   "issuer's resource set" that MUST encompass the resource set of the
   issued certificate. In this context "encompass" allows for the
   issuer's resource set to be the same as, or a strict superset of, any
   subject's resource set.

   Certificate validation entails the construction of a sequence of
   valid certificates in an issuer-subject chain (where the subject
   field of one certificate appears as the issuer in the next
   certificate in the sequence) from a trust anchor to the certificate
   being validated. Moreover, the resource extensions in this
   certificate sequence from the first CA under the trust anchor to the
   certificate being validated form a sequence of encompassing
   relationships in terms of the resources described in the resource
   extension.


















 


Kent, et al            Expires September 18, 2010               [Page 7]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


3.  BGPSEC Router Certificate Fields

   A BGPSEC Router Certificate is a valid X.509 public key certificate,
   consistent with the PKIX profile [RFC5380], containing the fields
   listed in this section. Unless specifically noted as being OPTIONAL,
   all the fields listed here MUST be present, and any other field MUST
   NOT appear in a conforming BGPSEC Router Certificate. Where a field
   value is specified here this value MUST be used in conforming BGPSEC
   Router certificates. For any BGPSEC Router certificate field that is
   the same as in the [ID.res-cert-prof] profile, this document will
   cite the corresponding section in that document.

3.1  Version

   Refer to section 3.1 of [ID.res-cert-prof].

3.2  Serial Number

   Refer to section 3.2 of [ID.res-cert-prof].

3.3  Signature Algorithm

   Refer to section 3.3 of [ID.res-cert-prof].

3.4  Issuer

   This field identifies the entity that has signed and issued the
   certificate. The value of this field is a valid X.501 distinguished
   name. Conventions are imposed on Issuer names used in resource
   certificates, as described in [ID.sidr-arch].

   A BGPSEC Router certificate is always an end entity certificate, and
   therefore it is always a subordinate certificate. Thus the Issuer
   name MUST correspond to the subject name as contained in the
   immediate superior certificate.

3.5  Subject

   This field identifies the router to which the certificate has been
   issued. Consistent with [ID.res-cert-prof], only two attributes are
   allowed in the Subject field: common name and serial number.
   Moreover, the only common name encoding options that are supported
   are printableString and UTF8String. For router certificates, it is
   RECOMMENDED that the common name attribute contain the literal string
   "ROUTER-" followed by the 32-bit router ID encoded as eight
   hexadecimal digits. If one certificate is issued to more than one
   router (hance the private key is shared among these routers), the
   choice of the router ID used in this name is at the discretion of the
 


Kent, et al            Expires September 18, 2010               [Page 8]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


   issuer. Note that router IDs are not guaranteed to be unique across
   the Internet, and thus the Subject name in a BGPSEC Router
   certificate issued using this convention also is not guaranteed to be
   unique across different issuers.

3.6  Valid From

   Refer to section 3.6 of [ID.res-cert-prof].

3.7  Valid To

   Refer to section 3.7 of [ID.res-cert-prof].

3.8  Subject Public Key Info

   Refer to section 3.8 of [ID.res-cert-prof].

3.9  BGPSEC Router Certificate Version 3 Extension Fields

   As noted in Section 4.2 of RFC 5280, each extension in a certificate
   is designated as either critical or non-critical. A certificate-using
   system MUST reject the certificate if it encounters a critical
   extension that it does not recognize; however, a non-critical
   extension MAY be ignored if it is not recognized.

   The following X.509 V3 extensions MUST be present in a conforming
   BGPSEC Router certificate, except where explicitly noted otherwise.

3.9.1  Basic Constraints

   The basic constraints extension identifies whether the subject of the
   certificate is a CA and the maximum depth of valid certification
   paths that include this certificate. Since a BGPSEC Router
   certificate is always an EE certificate, the basic constraints
   extension MUST NOT be present (and therefore the Path Length
   Constraint also MUST NOT be present).

3.9.2  Subject Key Identifier

   The subject key identifier extension provides a means of identifying
   certificates that contain a particular public key. To facilitate
   certification path construction, this extension MUST appear in all
   BGPSEC Router certificates. This extension is non-critical.

   The Key Identifier used here is the 160-bit SHA-1 hash of the value
   of the DER-encoded ASN.1 bit string of the subject public key, as
   described in section 4.2.1.2 of RFC 5280. 

 


Kent, et al            Expires September 18, 2010               [Page 9]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


3.9.3  Authority Key Identifier

   Refer to section 3.9.3 of [ID.res-cert-prof].

3.9.4  Key Usage

   This describes the purpose of the certificate. This is a critical
   extension, and it MUST be present. The digitalSignature bit MUST be
   set to TRUE in all BGPSEC Router certificates, and it MUST be the
   only bit set to TRUE.

3.9.5  Extended Key Usage

   The extended key usage (EKU) extension indicates one or more purposes
   for which the public key in a certificate may be used. The uses are
   specified via a SEQUENCE of one or more object identifiers (OIDs).

   The EKU extension MUST NOT appear in any BGPSEC Router certificates.

3.9.6  CRL Distribution Points

   Refer to section 3.9.6 of [ID.res-cert-prof].

3.9.7  Authority Information Access

   Refer to section 3.9.7 of [ID.res-cert-prof].

3.9.8  Subject Information Access

   This extension (SIA) identifies the location of information and
   services relating to the subject of the certificate in which the SIA
   extension appears.

   This extension is not used in BGPSEC Router certificates. It MUST be
   omitted.

3.9.9  Certificate Policies

   Refer to section 3.9.9 of [ID.res-cert-prof].

3.9.10  IP Resources

   This extension contains the list of IP address resources as per RFC
   3779. This extension is not used in BGPSEC Router certificates. It
   MUST be omitted.

3.9.11  AS Resources

 


Kent, et al            Expires September 18, 2010              [Page 10]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


   This extension contains the list of AS number resources as per RFC
   3779. The "inherit" element MUST NOT be specified. RDI values are NOT
   supported in this profile and MUST NOT be used. All BGPSEC Router
   certificates MUST include an AS resources extension. This extension
   MUST be marked critical.











































 


Kent, et al            Expires September 18, 2010              [Page 11]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


4.  BGPSEC Router Certificate Revocation List Profile

   BGPSEC Router certificates are just another type of EE certificate
   issued by an RPKI CA. Therefore, there are no distinguishing features
   for the CRLs on which they appear. Refer to section 4 of [ID.res-
   cert-prof] for a complete description of the profile for these CRLs.










































 


Kent, et al            Expires September 18, 2010              [Page 12]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


5.  BGPSEC Router Certificate Request Profile

   Provisioning of BGPSEC router certificates SHOULD occur entirely
   within an administrative entity (i.e., an ISP). However, certificate
   requests MAY be supported as well. A BGPSEC Router certificate
   request MAY use either of the PKCS#10 or Certificate Request Message
   Format (CRMF). A CA Issuer MAY support PKCS#10 and a CA Issuer MAY
   support CRMF, with the mutual consent of the subject. The profile for
   these requests is identical to that described in section 5 of
   [ID.res-cert-prof].






































 


Kent, et al            Expires September 18, 2010              [Page 13]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


6.  BGPSEC Router Certificate Validation

   This section describes the BGPSEC Router Certificate validation
   procedure. This refines the generic procedure described in Section 6
   of RFC 5280. The validation procedure used for BGPSEC Router
   certificates is identical to the validation procedure described in
   Section 6 of [ID.res-cert-prof], with the further restriction that
   all IP address resources for a BGPSEC Router certificate will be
   empty.







































 


Kent, et al            Expires September 18, 2010              [Page 14]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


7.  Design Notes

   The BGPSEC Router Certificate profile is based off the Resource
   Certificate profile as specified in [ID.res-cert-prof]. As a result,
   many of the design choices herein are a reflection of the design
   choices that were taken in that prior work. The reader is referred to
   [ID.res-cert-prof] for a fuller discussion of those choices.









































 


Kent, et al            Expires September 18, 2010              [Page 15]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


8.  Security Considerations

   The Security Considerations of RFC5280 and RFC3779 apply to BGPSEC
   Router Certificates as defined by this profile, and their use.

   A BGPSEC Router Certificate PKI cannot in and of itself resolve any
   forms of ambiguity relating to uniqueness of assertions of rights to
   use in the event that two or more valid certificates encompass the
   same resource. If the issuance of BGPSEC Router certificates is
   aligned to the status of AS resource allocations and assignments then
   the information conveyed in a certificate is no better that the
   information in the allocation and assignment databases.

9.  IANA Considerations

   [Note to IANA, to be removed prior to publication: there are no IANA
   considerations stated in this version of the document.]

10  References 

10.1  Normative References

   [ID.sidr-rpki-algs]
               Huston, G., "A Profile for Algorithms and Key Sizes for
               use in the Resource Public Key Infrastructure", work in
               progresss: Internet Drafts draft-ietf-sidr-rpki-algs-
               00.txt, August 2009.

   [RFC2050]   Hubbard, K., Kosters, M., Conrad, D., Karrenburg, D., and
               J. Postel, "INTERNET REGISTRY IP ALLOCATION GUIDELINES",
               BCP 12, RFC 2050, November 1996.

   [RFC2119]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3513]   Hinden, R., and S. Deering, "Internet Protocol Version 6
               (IPv6) Addressing Architecture", RFC 3513, April 2003.

   [RFC3779]   Lynn, C., Kent, S., and K. Seo, "X.509 Extensions for IP
               Addresses and AS Identifiers", RFC 3779, June 2004.

   [RFC4211]   Schaad, J., and S. Deering, "Internet X.509 Public Key
               Infrastructure Certificate Request Message Format
               (CRMF)", RFC 4211, June 2004.

   [RFC5280]   Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
               Housley, R., and W. Polk, "Internet X.509 Public Key
               Infrastructure Certificate and Certificate Revocation
 


Kent, et al            Expires September 18, 2010              [Page 16]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


               List (CRL) Profile", RFC 5280, May 2008.

   [X.509]   ITU-T, "Recommendation X.509: The Directory Authentication
               Format", 2000.

   [I-D. sidr-arch]
               Lepinski, M. and S. Kent, "An Infrastructure to Support
               Secure Internet Routing", draft-ietf-side-arch-09.txt
               (work in progress), October 2009.

   [I-D. sidr-manifests]
               Austein, R., Huston, G., Kent, S., and M. Lepinski,
               "Manifests for the Resource Public Key Intrastructure",
               Work in progress; Internet Draft draft-ietf-sidr-rpki-
               manifests-04.txt, October 2008.

   [I-D. sidr-res-cert-prof]
               Huston, G., Michaelson, G., and R. Loomans, "A Profile
               for X.509 PKIX Resource Certificates", draft-ietf-sidr-
               res-certs-17.txt (work in progress), September 2009.


10.2  Informative References

   [rsync]    Tridgell, A., "rsync", April 2006,
               <http://samba.anu.edu.au/rsync/>

Authors' Addresses


                 Stephen Kent
                 BBN Technologies
                 10 Moulton St.
                 Cambridge, MA 02138

                 Email: kent@bbn.com

                 Matt Lepinski
                 BBN Technologies
                 10 Moulton St.
                 Cambridge, MA 02138

                 Email: mlepinsk@bbn.com

                 Mark Reynolds
                 BBN Technologies
                 10 Moulton St.
                 Cambridge, MA 02138
 


Kent, et al            Expires September 18, 2010              [Page 17]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


                 Email: mreynold@bbn.com















































 


Kent, et al            Expires September 18, 2010              [Page 18]

Internet-Draft     BGPSEC Router Certificate Profile          March 2010


Appendix A: Example BGPSEC Router Certificate


   TBD

Appendix B: Example Certificate Revocation List

   TBD











































Kent, et al            Expires September 18, 2010              [Page 19]
